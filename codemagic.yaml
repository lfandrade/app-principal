workflows:
  flutter-release:
    name: Flutter Release Pipeline - Teste Docker MINIO
    environment:
      flutter: 3.22.0
      xcode: latest
    scripts:
      - name: Checkout do repositório
        script: git clone https://github.com/lfandrade/app_principal && cd projeto_flutter

      - name: Instalar Docker (se não estiver disponível)
        script: |
          if ! command -v docker &> /dev/null; then
            brew install --cask docker
            open --background -a Docker
            while ! docker system info &> /dev/null; do sleep 1; done
          fi

      - name: Subir serviço do MinIO
        script: |
          docker run -d --name minio \
            -e "MINIO_ROOT_USER=minioadmin" \
            -e "MINIO_ROOT_PASSWORD=minioadmin" \
            -p 9000:9000 \
            -p 9001:9001 \
            quay.io/minio/minio server /data --console-address ":9001"

      - name: Verificar serviço do MinIO
        script: |
          curl http://localhost:9000/minio/health/live

      # Suas outras etapas, como build e upload de artefatos...
